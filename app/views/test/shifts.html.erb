<h2>Shifts</h2>
<% volunteer_schedules = Schedule.where(:volunteer_id => current_volunteer) %>
<% if volunteer_schedules.length == 0 %>
<p> 
  You have no schedules to view. Please talk to an admin about getting assgined
   a pickup or pickup some open shifts at <%= link_to "cover shifts.", "/test/cover"%>
</p>
<% else %>
<% days_of_week = [ 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday' ] %>
<table id="my_schedule_table">
  <thead>
  <tr>
    <th> Day of Week </th>
    <th> Donor </th>
    <th> Recipient </th>
    <th> Volunteer </th>
    <th> Start Time </th>
    <th> End Time </th>
    <th> Notes </th>
    <th> Prior Volunteer </th>
    <th> Link </th>
  </tr>
  </thead>
  <tbody>
  <%
  volunteer_schedules.each do |schedule|
    if schedule.recipient != nil && schedule.volunteer != nil
  %>
  <tr>
    <td> <%= days_of_week[schedule.day_of_week] %> </td>
    <td> <%= link_to schedule.donor.name, schedule.donor %> </td>
    <td> <%= link_to schedule.recipient.name, schedule.recipient %> </td>
    <td> <%= link_to schedule.volunteer.name, schedule.volunteer %> </td>
    <td> <%= schedule.time_start %> </td>
    <td> <%= schedule.time_stop %> </td>
    <td>
      <% if schedule.public_notes != nil && schedule.public_notes.length > 47 %>
      <%= schedule.public_notes[0...47] + '...'%>
      <% else %>
      <%= schedule.public_notes %>
      <% end %>
    </td>
    <td>
      <% if schedule.prior_volunteer_id != nil && Volunteer.where(:id => schedule.prior_volunteer_id).present? %> 
      <%= Volunteer.find(schedule.prior_volunteer_id).name %>
      <% end %>
    </td>
    <td> <%= link_to 'view',  schedule %> </td>
  </tr>
  <%   end %>
  <% end %>
  </tbody>
</table>
<% end %>